#!/bin/bash

set -e

NAILGUN=ng-nailgun

if ! builtin type -p ${NAILGUN} &>/dev/null; then
	NAILGUN=ng
	if ! builtin type -p ${NAILGUN} &>/dev/null; then
		echo "${NAILGUN} not found; try sudo apt-get install nailgun"
		exit 1
	fi
fi

COMMAND=$@

pushd `dirname $0` > /dev/null
BASEDIR=`pwd`
popd > /dev/null

if [[ "$PROFILE" == "" ]]; then
	PROFILE=openstack
fi

. ~/.credentials/${PROFILE}

if [[ "$FORMAT" == "" ]]; then
	FORMAT=raw
fi

NAILGUN_PORT=2102 ${NAILGUN} org.openstack.client.cli.OpenstackCli --format "${FORMAT}" --username "${OS_USERNAME}" --password "${OS_PASSWORD}" --tenant "${OS_TENANT_NAME}" --server "${OS_AUTH_URL}" "${1}" "${2}" "${3}" "${4}" "${5}" "${6}" "${7}"

